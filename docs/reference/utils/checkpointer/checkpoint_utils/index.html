<!doctype html>
<html lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-alpha.75">
<link rel="alternate" type="application/rss+xml" href="/PyMarlin/blog/rss.xml" title="PyMarlin Blog RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/PyMarlin/blog/atom.xml" title="PyMarlin Blog Atom Feed"><title data-react-helmet="true">utils.checkpointer.checkpoint_utils | PyMarlin</title><meta data-react-helmet="true" property="og:url" content="https://github.com/microsoft/PyMarlin/PyMarlin/docs/reference/utils/checkpointer/checkpoint_utils"><meta data-react-helmet="true" name="docusaurus_locale" content="en"><meta data-react-helmet="true" name="docusaurus_version" content="current"><meta data-react-helmet="true" name="docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="utils.checkpointer.checkpoint_utils | PyMarlin"><meta data-react-helmet="true" name="description" content="Checkpointer class and utility functions."><meta data-react-helmet="true" property="og:description" content="Checkpointer class and utility functions."><link data-react-helmet="true" rel="shortcut icon" href="/PyMarlin/img/favicon.ico"><link data-react-helmet="true" rel="canonical" href="https://github.com/microsoft/PyMarlin/PyMarlin/docs/reference/utils/checkpointer/checkpoint_utils"><link data-react-helmet="true" rel="alternate" href="https://github.com/microsoft/PyMarlin/PyMarlin/docs/reference/utils/checkpointer/checkpoint_utils" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://github.com/microsoft/PyMarlin/PyMarlin/docs/reference/utils/checkpointer/checkpoint_utils" hreflang="x-default"><link rel="stylesheet" href="/PyMarlin/assets/css/styles.4339f032.css">
<link rel="preload" href="/PyMarlin/assets/js/runtime~main.818683f0.js" as="script">
<link rel="preload" href="/PyMarlin/assets/js/main.14617061.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div><a href="#main" class="skipToContent_1oUP">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle" type="button" tabindex="0"><svg aria-label="Menu" width="30" height="30" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/PyMarlin/"><img src="/PyMarlin/img/logo.svg" alt="My Site Logo" class="themedImage_1VuW themedImage--light_3UqQ navbar__logo"><img src="/PyMarlin/img/logo.svg" alt="My Site Logo" class="themedImage_1VuW themedImage--dark_hz6m navbar__logo"><strong class="navbar__title">PyMarlin</strong></a><a class="navbar__item navbar__link" href="/PyMarlin/docs/getting-started">Docs</a><a class="navbar__item navbar__link navbar__link--active" href="/PyMarlin/docs/reference/core/module_interface">SDK</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/microsoft/PyMarlin" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub</a><div class="react-toggle displayOnlyInLargeViewport_GrZ2 react-toggle--disabled" role="button" tabindex="-1"><div class="react-toggle-track"><div class="react-toggle-track-check"><span class="toggle_71bT">ðŸŒœ</span></div><div class="react-toggle-track-x"><span class="toggle_71bT">ðŸŒž</span></div></div><div class="react-toggle-thumb"></div><input type="checkbox" class="react-toggle-screenreader-only" aria-label="Switch between dark and light mode"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div><div class="navbar-sidebar"><div class="navbar-sidebar__brand"><a class="navbar__brand" href="/PyMarlin/"><img src="/PyMarlin/img/logo.svg" alt="My Site Logo" class="themedImage_1VuW themedImage--light_3UqQ navbar__logo"><img src="/PyMarlin/img/logo.svg" alt="My Site Logo" class="themedImage_1VuW themedImage--dark_hz6m navbar__logo"><strong class="navbar__title">PyMarlin</strong></a></div><div class="navbar-sidebar__items"><div class="menu"><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/PyMarlin/docs/getting-started">Docs</a></li><li class="menu__list-item"><a class="menu__link navbar__link--active" href="/PyMarlin/docs/reference/core/module_interface">SDK</a></li><li class="menu__list-item"><a href="https://github.com/microsoft/PyMarlin" target="_blank" rel="noopener noreferrer" class="menu__link">GitHub</a></li></ul></div></div></div></nav><div class="main-wrapper docs-wrapper doc-page"><div class="docPage_31aa"><div class="docSidebarContainer_3Kbt" role="complementary"><div class="sidebar_15mo"><div class="menu menu--responsive thin-scrollbar menu_Bmed"><button aria-label="Open menu" aria-haspopup="true" class="button button--secondary button--sm menu__button" type="button"><svg aria-label="Menu" class="sidebarMenuIcon_fgN0" width="24" height="24" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><ul class="menu__list"><li class="menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#!">Reference</a><ul class="menu__list"><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="0">core</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/PyMarlin/docs/reference/core/data_interface">data_interface</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/PyMarlin/docs/reference/core/module_interface">module_interface</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/PyMarlin/docs/reference/core/trainer">trainer</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/PyMarlin/docs/reference/core/trainer_backend">trainer_backend</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="0">plugins</a><ul class="menu__list"><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">plugins.hf_ner</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/PyMarlin/docs/reference/plugins/hf_ner/data_classes">data_classes</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/PyMarlin/docs/reference/plugins/hf_ner/implementation">implementation</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/PyMarlin/docs/reference/plugins/hf_ner/module_classes">module_classes</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/PyMarlin/docs/reference/plugins/hf_ner/sequence_labelling_metrics">sequence_labelling_metrics</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">plugins.hf_seq2seq</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/PyMarlin/docs/reference/plugins/hf_seq2seq/data_classes">data_classes</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/PyMarlin/docs/reference/plugins/hf_seq2seq/implementation">implementation</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">plugins.hf_seq_classification</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/PyMarlin/docs/reference/plugins/hf_seq_classification/data_classes">data_classes</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/PyMarlin/docs/reference/plugins/hf_seq_classification/implementation">implementation</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/PyMarlin/docs/reference/plugins/hf_seq_classification/module_classes">module_classes</a></li></ul></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/PyMarlin/docs/reference/plugins/base">base</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/PyMarlin/docs/reference/plugins/plugin_module_interface">plugin_module_interface</a></li></ul></li><li class="menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#!" tabindex="0">utils</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#!" tabindex="0">utils.checkpointer</a><ul class="menu__list"><li class="menu__list-item"><a aria-current="page" class="menu__link menu__link--active active" tabindex="0" href="/PyMarlin/docs/reference/utils/checkpointer/checkpoint_utils">checkpoint_utils</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="0">utils.config_parser</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/PyMarlin/docs/reference/utils/config_parser/custom_arg_parser">custom_arg_parser</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="0">utils.logger</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/PyMarlin/docs/reference/utils/logger/logging_utils">logging_utils</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="0">utils.misc</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/PyMarlin/docs/reference/utils/misc/misc_utils">misc_utils</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="0">utils.stats</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/PyMarlin/docs/reference/utils/stats/basic_stats">basic_stats</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="0">utils.writer</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/PyMarlin/docs/reference/utils/writer/__init__">writer</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/PyMarlin/docs/reference/utils/writer/aml">aml</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/PyMarlin/docs/reference/utils/writer/base">base</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/PyMarlin/docs/reference/utils/writer/stdout">stdout</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/PyMarlin/docs/reference/utils/writer/tensorboard">tensorboard</a></li></ul></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/PyMarlin/docs/reference/utils/distributed">distributed</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/PyMarlin/docs/reference/utils/fabrics">fabrics</a></li></ul></li></ul></li></ul></div></div></div><main class="docMainContainer_3ufF"><div class="container padding-vert--lg docItemWrapper_3FMP"><div class="row"><div class="col docItemCol_3FnS"><div class="docItemContainer_33ec"><article><header><h1 class="docTitle_3a4h">utils.checkpointer.checkpoint_utils</h1></header><div class="markdown"><p>Checkpointer class and utility functions.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="checkpoint-objects"></a>Checkpoint Objects<a class="hash-link" href="#checkpoint-objects" title="Direct link to heading">#</a></h2><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly python"><div tabindex="0" class="prism-code language-python codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token decorator annotation punctuation" style="color:rgb(199, 146, 234)">@dataclass</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword" style="font-style:italic">class</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(255, 203, 107)">Checkpoint</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>Checkpoint data class that holds the states for
module_interface, trainer and trainer_backend</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="defaultcheckpointerarguments-objects"></a>DefaultCheckpointerArguments Objects<a class="hash-link" href="#defaultcheckpointerarguments-objects" title="Direct link to heading">#</a></h2><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly python"><div tabindex="0" class="prism-code language-python codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token decorator annotation punctuation" style="color:rgb(199, 146, 234)">@dataclass</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword" style="font-style:italic">class</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(255, 203, 107)">DefaultCheckpointerArguments</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>Default Checkpointer Arguments.</p><p><strong>Arguments</strong>:</p><ul><li><code>checkpoint</code> <em>bool</em> - Flag indicating whether to checkpoint model when save()
is called. Other conditions are implemented within save(), allowing this
method to always be called within training loops and abstracting the
checkpointing logic out of Trainer and implemented in this class.</li><li><code>delete_existing_checkpoints</code> <em>bool</em> - Flag indicating whether to delete checkpoints
under save_dir before training. New checkpoints are saved regardless.</li><li><code>period</code> <em>int</em> - Period of index at which to checkpoint model. Evaluates
index % period == 0. This function is called with index set to the
epoch, and thus checkpoints every &quot;period&quot; number of epochs. The last
epoch is always checkpointed regardless.</li><li><code>save_dir</code> <em>str</em> - Path to directory where checkpoints are to be stored. Creates
folder if it does not exist.</li><li><code>model_state_save_dir</code> <em>str</em> - Path to directory where checkpointed models are to
be stored. Creates folder if it does not exist.</li><li><code>load_dir</code> <em>str</em> - Path to directory where checkpoints are to be loaded from.
If not set, will not attempt to load a checkpoint. If load_filename
is set, will search for this filename within the directory to load it.
If load_filename is not set, will load the file via get_latest_file().</li><li><code>load_filename</code> <em>str</em> - Filename of checkpoint to load under load_dir, overrides
automatic loading via get_latest_file().</li><li><code>file_prefix</code> <em>str</em> - Prefix of the checkpoint filename. Final filename to save
will be {file<em>prefix}</em>{index}.{file<em>ext}, or in the case of saving with
save_model(), {file_prefix}_mode</em>{index}.{file_ext}.</li><li><code>file_ext</code> <em>str</em> - File extension for the checkpoint filename when saving and when
searching under load_dir for loading via get_latest_file().
When cleaning save_dir via delete_existing_checkpoints=True, only files
with this extension are considered.</li><li><code>log_level</code> <em>str</em> - Logging level for checkpointer module (Default: &#x27;INFO&#x27;).</li></ul><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="abstractcheckpointer-objects"></a>AbstractCheckpointer Objects<a class="hash-link" href="#abstractcheckpointer-objects" title="Direct link to heading">#</a></h2><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly python"><div tabindex="0" class="prism-code language-python codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token keyword" style="font-style:italic">class</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(255, 203, 107)">AbstractCheckpointer</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">ABC</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>Abstract class for a checkpointer.</p><p>To create a custom checkpointer, users must implement the abstract
methods of this class and pass along an instance to ModuleInterface.
Custom checkpointers can be used at other stages of the
training lifecycle via callbacks.</p><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="save"></a>save<a class="hash-link" href="#save" title="Direct link to heading">#</a></h4><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly python"><div tabindex="0" class="prism-code language-python codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">|</span><span class="token plain"> @abstractmethod</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">|</span><span class="token plain"> save</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">checkpoint_state</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> Checkpoint</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> index</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token builtin" style="color:rgb(130, 170, 255)">int</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> force</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> Optional</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token builtin" style="color:rgb(130, 170, 255)">bool</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">-</span><span class="token operator" style="color:rgb(137, 221, 255)">&gt;</span><span class="token plain"> </span><span class="token boolean" style="color:rgb(255, 88, 116)">None</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>Creates a checkpoint by saving a Checkpoint dataclass containing any
relevant states.</p><p><strong>Arguments</strong>:</p><ul><li><code>checkpoint_state</code> <em>Checkpoint</em> - Checkpointed states.</li><li><code>index</code> <em>int</em> - Using epoch as index is suggested.</li><li><code>force</code> <em>bool, optional</em> - Saves checkpoint regardless of conditions
if args.checkpoint is set to True. Used to always checkpoint
models after the last epoch.</li></ul><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="save_model"></a>save_model<a class="hash-link" href="#save_model" title="Direct link to heading">#</a></h4><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly python"><div tabindex="0" class="prism-code language-python codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">|</span><span class="token plain"> save_model</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">model_state</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> Dict</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> index</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token builtin" style="color:rgb(130, 170, 255)">int</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">-</span><span class="token operator" style="color:rgb(137, 221, 255)">&gt;</span><span class="token plain"> </span><span class="token boolean" style="color:rgb(255, 88, 116)">None</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>Creates a model checkpoint by saving model state.</p><p><strong>Arguments</strong>:</p><ul><li><code>model_state</code> <em>Dict</em> - Model state as provided by ModuleInterface.</li><li><code>index</code> <em>int</em> - Number to use to create a unique filename.
Using epoch as index is suggested.</li></ul><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="load"></a>load<a class="hash-link" href="#load" title="Direct link to heading">#</a></h4><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly python"><div tabindex="0" class="prism-code language-python codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">|</span><span class="token plain"> @abstractmethod</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">|</span><span class="token plain"> load</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">-</span><span class="token operator" style="color:rgb(137, 221, 255)">&gt;</span><span class="token plain"> Checkpoint</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>Load and return a checkpointed file.</p><p>Implements logic to load a checkpointed file as configured
via args used when constructing the checkpointer object. Always called
upon initialization of Trainer.</p><p><strong>Returns</strong>:</p><ul><li><code>Checkpoint</code> - Checkpointed states.</li></ul><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="defaultcheckpointer-objects"></a>DefaultCheckpointer Objects<a class="hash-link" href="#defaultcheckpointer-objects" title="Direct link to heading">#</a></h2><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly python"><div tabindex="0" class="prism-code language-python codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token keyword" style="font-style:italic">class</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(255, 203, 107)">DefaultCheckpointer</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">AbstractCheckpointer</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>Default checkpointer implementation, implements AbstractCheckpointer and
contains a few helper functions for managing checkpointed files.</p><p>Must be initialized with DefaultCheckpointerArguments.</p><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="__init__"></a>__init__<a class="hash-link" href="#__init__" title="Direct link to heading">#</a></h4><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly python"><div tabindex="0" class="prism-code language-python codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">|</span><span class="token plain"> __init__</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">args</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> DefaultCheckpointerArguments</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>Initialize checkpointer and delete existing checkpointed files
under save_dir if delete_existing_checkpoints is set to True.</p><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="save-1"></a>save<a class="hash-link" href="#save-1" title="Direct link to heading">#</a></h4><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly python"><div tabindex="0" class="prism-code language-python codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">|</span><span class="token plain"> save</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">checkpoint_state</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> Checkpoint</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> index</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token builtin" style="color:rgb(130, 170, 255)">int</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> force</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token boolean" style="color:rgb(255, 88, 116)">False</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">-</span><span class="token operator" style="color:rgb(137, 221, 255)">&gt;</span><span class="token plain"> </span><span class="token builtin" style="color:rgb(130, 170, 255)">str</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>Creates a checkpoint by saving a Checkpoint dataclass containing any
relevant states as a python Dict.</p><p>Evaluates conditions and, if met, saves a provided dataclass
which should contain any states that users require to save as
part of a checkpoint under args.save_dir. An additional index
argument is required to create a unique name for the file to be
saved. The optional force flag will disregard conditions other
than the checkpoint flag that enables this behavior. The condition
for saving with DefaultCheckpointer is index being a multiple
of the args.period.</p><p><strong>Arguments</strong>:</p><ul><li><code>checkpoint_state</code> <em>Checkpoint</em> - Checkpointed states.</li><li><code>index</code> <em>int</em> - Number to use to create a unique filename and
evaluate conditions for checkpointing. Using epoch as index
is suggested.</li><li><code>force</code> <em>bool, optional</em> - Saves checkpoint regardless of conditions
if args.checkpoint is set to True. Used to always checkpoint
states after the last epoch.</li></ul><p><strong>Returns</strong>:</p><ul><li><code>str</code> - Path to checkpointed file.</li></ul><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="save_model-1"></a>save_model<a class="hash-link" href="#save_model-1" title="Direct link to heading">#</a></h4><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly python"><div tabindex="0" class="prism-code language-python codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">|</span><span class="token plain"> save_model</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">model_state</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> Dict</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> index</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token builtin" style="color:rgb(130, 170, 255)">int</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">-</span><span class="token operator" style="color:rgb(137, 221, 255)">&gt;</span><span class="token plain"> </span><span class="token builtin" style="color:rgb(130, 170, 255)">str</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>Checkpoints a model state, leveraging torch.save().</p><p>Evaluates if checkpointing is enabled and if a model save directory
has been set, and saves a provided model state. An additional index
argument is required to create a unique name for the file to be
saved.</p><p><strong>Arguments</strong>:</p><ul><li><code>model_state</code> <em>Dict</em> - Model state as provided by ModuleInterface.</li><li><code>index</code> <em>int</em> - Number to use to create a unique filename.
Using epoch as index is suggested.</li></ul><p><strong>Returns</strong>:</p><ul><li><code>str</code> - Path to checkpointed file.</li></ul><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="load-1"></a>load<a class="hash-link" href="#load-1" title="Direct link to heading">#</a></h4><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly python"><div tabindex="0" class="prism-code language-python codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">|</span><span class="token plain"> load</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">-</span><span class="token operator" style="color:rgb(137, 221, 255)">&gt;</span><span class="token plain"> Checkpoint</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>Attempt to load and return a checkpointed file leveraging torch.load().
The checkpoined file is assumed to be created with save() and thus be
a python Dict.</p><p>This method is always called upon initialization of Trainer.
Searches for and attempts to load a checkpointed file based on
args. If no load_dir is set, returns None. If a load_dir and
load_filename have been set, the file &quot;load_filename&quot; under
load_dir is directly loaded (the filename must include extension).
If only load_dir is set, get_latest_file() is called to seach the
folder for the file with the largest integer (index) in its filename,
and returns that path for loading.</p><p><strong>Returns</strong>:</p><ul><li><code>Checkpoint</code> - Checkpointed states.</li></ul><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="get_latest_file"></a>get_latest_file<a class="hash-link" href="#get_latest_file" title="Direct link to heading">#</a></h4><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly python"><div tabindex="0" class="prism-code language-python codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">|</span><span class="token plain"> @</span><span class="token builtin" style="color:rgb(130, 170, 255)">staticmethod</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">|</span><span class="token plain"> get_latest_file</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">load_dir</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token builtin" style="color:rgb(130, 170, 255)">str</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> file_prefix</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token builtin" style="color:rgb(130, 170, 255)">str</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> file_ext</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token builtin" style="color:rgb(130, 170, 255)">str</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;pt&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> logger</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">getlogger</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">__name__</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">-</span><span class="token operator" style="color:rgb(137, 221, 255)">&gt;</span><span class="token plain"> </span><span class="token builtin" style="color:rgb(130, 170, 255)">str</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>Get the path to the last checkpointed file.</p><p>Find and return the path of the file with greatest number of
completed epochs under dirpath (recursive search) for a given file
prefix, and optionally file extension.</p><p><strong>Arguments</strong>:</p><ul><li><code>load_dir</code> <em>str</em> - Directory under which to search for
checkpointed files.</li><li><code>file_prefix</code> <em>str</em> - Prefix to match for when searching
for candidate files.</li><li><code>file_ext</code> <em>str, optional</em> - File extension to consider
when searching.</li></ul><p><strong>Returns</strong>:</p><ul><li><code>str</code> - Path to latest checkpointed file.</li></ul><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="check_mk_dir"></a>check_mk_dir<a class="hash-link" href="#check_mk_dir" title="Direct link to heading">#</a></h4><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly python"><div tabindex="0" class="prism-code language-python codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">|</span><span class="token plain"> check_mk_dir</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">dirpath</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token builtin" style="color:rgb(130, 170, 255)">str</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">-</span><span class="token operator" style="color:rgb(137, 221, 255)">&gt;</span><span class="token plain"> </span><span class="token boolean" style="color:rgb(255, 88, 116)">None</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>Check if the path exists, and if it doesn&#x27;t creates it.</p><p><strong>Arguments</strong>:</p><ul><li><code>dirpath</code> <em>str</em> - Directory under which to search for
checkpointed files.</li></ul></div></article><div class="margin-vert--xl"><div class="row"><div class="col"><a href="https://github.com/microsoft/PyMarlin/edit/master/website/docs/reference/utils/checkpointer/checkpoint_utils.md" target="_blank" rel="noreferrer noopener"><svg fill="currentColor" height="1.2em" width="1.2em" preserveAspectRatio="xMidYMid meet" role="img" viewBox="0 0 40 40" class="iconEdit_2_ui" aria-label="Edit page"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div></div></div><div class="margin-vert--lg"><nav class="pagination-nav" aria-label="Docs pages navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/PyMarlin/docs/reference/plugins/plugin_module_interface"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Â« plugins.plugin_module_interface</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/PyMarlin/docs/reference/utils/config_parser/custom_arg_parser"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">utils.config_parser.custom_arg_parser Â»</div></a></div></nav></div></div></div><div class="col col--3"><div class="tableOfContents_35-E thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#checkpoint-objects" class="table-of-contents__link">Checkpoint Objects</a></li><li><a href="#defaultcheckpointerarguments-objects" class="table-of-contents__link">DefaultCheckpointerArguments Objects</a></li><li><a href="#abstractcheckpointer-objects" class="table-of-contents__link">AbstractCheckpointer Objects</a></li><li><a href="#defaultcheckpointer-objects" class="table-of-contents__link">DefaultCheckpointer Objects</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container"><div class="row footer__links"><div class="col footer__col"><h4 class="footer__title">Docs</h4><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/PyMarlin/docs/getting-started">Getting Started</a></li></ul></div><div class="col footer__col"><h4 class="footer__title">Community</h4><ul class="footer__items"><li class="footer__item"><a href="https://stackoverflow.com/questions/tagged/pymarlin" target="_blank" rel="noopener noreferrer" class="footer__link-item">Stack Overflow</a></li></ul></div><div class="col footer__col"><h4 class="footer__title">More</h4><ul class="footer__items"><li class="footer__item"><a href="https://github.com/microsoft/PyMarlin" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub</a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright Â© 2021 Microsoft Inc. Built with Docusaurus.</div></div></div></footer></div>
<script src="/PyMarlin/assets/js/runtime~main.818683f0.js"></script>
<script src="/PyMarlin/assets/js/main.14617061.js"></script>
</body>
</html>